"use strict";(function(){window.getUserMedia=function(n,t,i){var e,r,o,u,c,s,h,l,a,f;if(n!==undefined)if(navigator.getUserMedia_=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,!navigator.getUserMedia_)(n.noFallback===undefined||n.noFallback===!1)&&(l='<object id="XwebcamXobjectX" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" type="application/x-shockwave-flash" data="'+n.swffile+'" width="'+n.width+'" height="'+n.height+'"><param name="movie" value="'+n.swffile+'" /><param name="FlashVars" value="mode='+n.mode+"&amp;quality="+n.quality+'" /><param name="allowScriptAccess" value="always" /><\/object>',a=document.getElementById(n.el),a.innerHTML=l,function v(r){f=document.getElementById("XwebcamXobjectX");f.capture!==undefined?(n.capture=function(n){try{return f.capture(n)}catch(t){}},n.save=function(n){try{return f.save(n)}catch(t){}},n.setCamera=function(n){try{return f.setCamera(n)}catch(t){}},n.getCameraList=function(){try{return f.getCameraList()}catch(n){}},n.context="flash",n.onLoad=t):r===0?i():window.setTimeout(v,1e3*(4-r),r-1)}(3));else{e={};r="";n.video===!0&&(e.video=!0,r="video");n.audio===!0&&(e.audio=!0,r!==""&&(r=r+", "),r=r+"audio");o=document.getElementById(n.el);u=document.createElement("video");s=parseInt(o.offsetWidth,10);h=parseInt(o.offsetHeight,10);n.width<s&&n.height<h&&(n.width=s,n.height=h);u.width=n.width;u.height=n.height;u.autoplay=!0;o.appendChild(u);c=u;n.videoEl=c;n.context="webrtc";try{navigator.getUserMedia_(e,t,i)}catch(y){try{navigator.getUserMedia_(r,t,i)}catch(p){return undefined}}}};window.hasUserMedia=function(){return window.getUserMedia?!0:!1}})();angular.module("webcam",[]).directive("webcam",function(){return{template:'<div class="webcam" id="webcam" ng-transclude><\/div>',restrict:"E",replace:!0,transclude:!0,scope:{onError:"&",onStream:"&",onStreaming:"&",placeholder:"=",videoHeight:"=",videoWidth:"=",video:"="},link:function(n,t){var i=null,u=null,r=null,f=function(n){n&&angular.element(n).remove()},e=function(){!u||typeof u.stop!="function"||u.stop();!i||delete i.src},h=function(t){if(u=t,navigator.mozGetUserMedia)i.mozSrcObject=t;else{var r=window.URL||window.webkitURL;i.src=r.createObjectURL(t)}if(i.play(),n.video=i,n.onStream)n.onStream({stream:t})},o=function(t){if(f(r),console&&console.log&&console.log("The following error occured: ",t),n.onError)n.onError({err:t});return},s=function(){var c;i=document.createElement("video");i.setAttribute("class","webcam-live");i.setAttribute("autoplay","");t.append(i);n.placeholder&&(r=document.createElement("img"),r.setAttribute("class","webcam-loader"),r.src=n.placeholder,t.append(r));var u=!1,e=t.width=n.videoWidth||320,s=t.height=0;if(!window.hasUserMedia()){o({code:-1,msg:"Browser does not support getUserMedia."});return}c={video:!0,audio:!1,el:"webcam",width:320,height:240,mode:"callback",swffile:"../jscam/jscam_canvas_only.swf",quality:85,context:""};window.getUserMedia(c,h,o);i.addEventListener("canplay",function(){if(!u){var t=e/i.videoWidth;s=i.videoHeight*t||n.videoHeight;i.setAttribute("width",e);i.setAttribute("height",s);u=!0;n.video=i;f(r);n.onStreaming&&n.onStreaming()}},!1)},c=function(){e();i.remove()};n.$on("$destroy",e);n.$on("START_WEBCAM",s);n.$on("STOP_WEBCAM",c);s()}}});
//# sourceMappingURL=webcam.min.js.map
